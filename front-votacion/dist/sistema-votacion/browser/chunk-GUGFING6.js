import{a as b}from"./chunk-2BIOR5CR.js";import{a as k,c as A,d as E,e as M,f as P,h as B}from"./chunk-ZLLD3L34.js";import{D as g,Ea as j,F as p,G as _,Ga as N,H as o,Ha as I,I as s,J as m,L as S,M as v,P as c,Q as C,R as F,da as O,ea as w,ia as R,l as u,p as x,q as h,x as l,y as f}from"./chunk-ZHU3U647.js";function J(i,t){i&1&&(o(0,"div",9),c(1," No hay resultados a\xFAn. "),s())}function U(i,t){if(i&1&&(o(0,"li",25)(1,"span"),c(2),s(),o(3,"span",26),c(4),s()()),i&2){let d=t.$implicit,r=t.index,e=v().$implicit;l(2),C(d),l(2),F("",e.data.datasets[0].data[r]," votos")}}function V(i,t){if(i&1&&(o(0,"div",18)(1,"h2",19),c(2),s(),o(3,"div",20)(4,"div",21),m(5,"p-chart",22),s()(),o(6,"ul",23),g(7,U,5,2,"li",24),s()()),i&2){let d=t.$implicit,r=t.index,e=v(2);_("active",r===0),l(2),C(d.pregunta),l(3),p("data",d.data)("options",e.chartOptions),l(2),p("ngForOf",d.data.labels)}}function q(i,t){if(i&1&&(o(0,"div")(1,"div",10)(2,"div",11),g(3,V,8,6,"div",12),s(),o(4,"button",13),m(5,"span",14),o(6,"span",15),c(7,"Previous"),s()(),o(8,"button",16),m(9,"span",17),o(10,"span",15),c(11,"Next"),s()()()()),i&2){let d=v();l(3),p("ngForOf",d.reporteria)}}var T=(()=>{let t=class t{constructor(r,e,a){this.router=r,this.route=e,this.votacionService=a,this.reporteria=[],this.currentRole=0,this.title="Resultados",this.baseColors=["#42A5F5","#66BB6A","#FFA726","#FF7043","#AB47BC"],this.chartOptions={responsive:!0,maintainAspectRatio:!0,plugins:{legend:{labels:{color:"#495057"}}}}}ngOnInit(){this.route.params.subscribe(a=>{this.asambleaId=+a.asambleaId,this.preguntaId=+a.preguntaId}),this.asambleaId&&this.refreshResultados();let r=JSON.parse(localStorage.getItem("asambleaId")??"{}");this.asambleaId=r.id_asamblea||0;let e=JSON.parse(localStorage.getItem("currentUser")||"{}");this.currentRole=e.id_rol||0}refreshResultados(){this.asambleaId&&this.votacionService.getReporteriaById(k.reporteria,this.asambleaId,this.preguntaId).subscribe(r=>{this.processChartData(r)})}processChartData(r){if(Array.isArray(r.respuesta)){let e=this.groupBy(r.respuesta,"id_pregunta");this.reporteria=Object.keys(e).map(a=>{let n=e[a];return{pregunta:n[0].descripcion,data:{labels:n.map(y=>y.opcion),datasets:[{data:n.map(y=>y.total_votos),backgroundColor:this.assignColors(n.length)}]}}})}else this.reporteria=[]}groupBy(r,e){return r.reduce((a,n)=>((a[n[e]]=a[n[e]]||[]).push(n),a),{})}assignColors(r){let e=[],a=0;for(let n=0;n<r;n++)e.push(this.baseColors[a]),a=(a+1)%this.baseColors.length;return e}volver(r){switch(r){case 1:this.router.navigate(["/home/preguntas",this.asambleaId]);break;case 2:this.router.navigate(["asambleas/editar-preguntas",this.asambleaId]);break;case 3:this.router.navigate(["asambleas/editar-preguntas",this.asambleaId]);break;default:this.router.navigate(["/"]);break}}};t.\u0275fac=function(e){return new(e||t)(f(N),f(j),f(b))},t.\u0275cmp=x({type:t,selectors:[["app-resultado"]],decls:13,vars:2,consts:[[1,"container"],[1,"abs-center"],[1,"card","card-primary","shadow-lg","border-0"],[1,"card-body"],["class","alert alert-danger mt-4",4,"ngIf"],[4,"ngIf"],[1,"row","mt-3"],[1,"col","d-flex","justify-content-center"],["type","button",1,"btn","btn-secondary","w-100","w-md-auto",3,"click"],[1,"alert","alert-danger","mt-4"],["id","resultadosCarousel","data-bs-ride","carousel",1,"carousel","slide"],[1,"carousel-inner"],["class","carousel-item",3,"active",4,"ngFor","ngForOf"],["type","button","data-bs-target","#resultadosCarousel","data-bs-slide","prev",1,"carousel-control-prev"],["aria-hidden","true",1,"carousel-control-prev-icon","rounded",2,"background-color","black"],[1,"visually-hidden"],["type","button","data-bs-target","#resultadosCarousel","data-bs-slide","next",1,"carousel-control-next"],["aria-hidden","true",1,"carousel-control-next-icon","rounded",2,"background-color","black"],[1,"carousel-item"],[1,"text-center","fs-2","text-primary","mb-4"],[1,"d-flex","justify-content-center"],[1,"chart-container",2,"position","relative","height","auto","width","60%","max-width","600px"],["type","pie",3,"data","options"],[1,"list-group","mt-4"],["class","list-group-item d-flex justify-content-between align-items-center rounded",4,"ngFor","ngForOf"],[1,"list-group-item","d-flex","justify-content-between","align-items-center","rounded"],[1,"badge","bg-primary","rounded-pill"]],template:function(e,a){e&1&&(m(0,"app-animation")(1,"app-nav"),o(2,"div",0)(3,"div",1)(4,"div",2)(5,"div",3),g(6,J,2,0,"div",4)(7,q,12,1,"div",5),o(8,"div",6)(9,"div",7)(10,"button",8),S("click",function(){return a.volver(a.currentRole)}),c(11," Volver "),s()()()()()()(),m(12,"app-footer")),e&2&&(l(6),p("ngIf",!a.reporteria||a.reporteria.length===0),l(),p("ngIf",a.reporteria&&a.reporteria.length>0))},dependencies:[O,w,A,E,M,P],styles:[".chart-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;width:100%}p-chart[_ngcontent-%COMP%]{width:35rem}.container[_ngcontent-%COMP%]{padding:1rem}.abs-center[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:70vh}.card[_ngcontent-%COMP%]{min-width:90vw}"]});let i=t;return i})();var z=[{path:"",component:T}],$=(()=>{let t=class t{};t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h({type:t}),t.\u0275inj=u({imports:[I.forChild(z),I]});let i=t;return i})();var ct=(()=>{let t=class t{};t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h({type:t}),t.\u0275inj=u({providers:[b],imports:[R,$,B]});let i=t;return i})();export{ct as ResultadoModule};
