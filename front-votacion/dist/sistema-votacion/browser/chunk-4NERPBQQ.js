import{a as V,b as F,c as ee,h as te}from"./chunk-ZLLD3L34.js";import{D as S,F as C,Ga as q,H as s,Ha as N,I as m,Ia as p,J as P,Ja as E,K as T,Ka as H,L as U,La as J,M as W,Ma as G,Na as Z,O as L,Oa as z,P as l,Pa as K,Q as D,Qa as Q,S as x,T as b,U as M,Wa as X,Xa as Y,Ya as $,ea as B,f as R,ia as O,k as h,l as v,m as w,na as I,p as k,q as y,r as u,s as f,x as d,y as g}from"./chunk-ZHU3U647.js";var j=(()=>{let e=class e extends F{constructor(i){super(i,p.apiURL),this.http=i,this.apiurl=p.apiURL}};e.\u0275fac=function(r){return new(r||e)(w(I))},e.\u0275prov=h({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var A=(()=>{let e=class e extends F{constructor(i){super(i,p.apiURL),this.http=i,this.apiurl=p.apiURL}};e.\u0275fac=function(r){return new(r||e)(w(I))},e.\u0275prov=h({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function me(t,e){t&1&&(s(0,"div")(1,"small",17),l(2,"Ingrese un correo electr\xF3nico v\xE1lido"),m()())}function ce(t,e){t&1&&(s(0,"div")(1,"small",17),l(2," La contrase\xF1a debe tener al menos 8 caracteres, una letra may\xFAscula, un n\xFAmero y un car\xE1cter especial. "),m()())}function le(t,e){if(t&1&&(s(0,"div",18),l(1),m()),t&2){let oe=W();d(),D(oe.errorMessage)}}var ie=(()=>{let e=class e{constructor(i,r,o,a){this.authService=i,this.router=r,this.rolesService=o,this.documentosService=a,this.email="",this.password="",this.isAdmin=!1,this.errorMessage=""}onLogin(){return R(this,null,function*(){let i=this.isAdmin?"login":"loginUsuario";try{let o=(yield this.authService.login(i,this.email,this.password).toPromise()).respuesta;this.authService.setCurrentUser(o);try{let n=yield this.rolesService.get(V.getAllRoles).toPromise();localStorage.setItem("roles",JSON.stringify(n))}catch(n){console.error("Error al consultar roles:",n)}try{let n=yield this.documentosService.get(V.getAllDocumentos).toPromise();localStorage.setItem("documentos",JSON.stringify(n))}catch(n){console.error("Error al consultar roles:",n)}let a=this.getRedirectUrl(o.id_rol);this.router.navigate([a])}catch(r){console.error("Error al iniciar sesi\xF3n:",r),this.errorMessage="Credenciales inv\xE1lidas"}})}getRedirectUrl(i){switch(i){case 1:return"/home";case 2:return"/asambleas";case 3:return"/administradores";default:return"/"}}};e.\u0275fac=function(r){return new(r||e)(g(E),g(q),g(j),g(A))},e.\u0275cmp=k({type:e,selectors:[["app-login"]],decls:26,vars:6,consts:[["loginForm","ngForm"],["passwordField","ngModel"],[1,"container","d-flex","justify-content-center","align-items-center","min-vh-100"],[1,"card","shadow-lg","p-4","border-0",2,"border-radius","15px","max-width","400px","width","100%"],[1,"card-body"],[1,"text-center","mb-4"],[3,"ngSubmit"],[1,"input-group","mb-3"],[1,"input-group-text","bg-white","border-end-0","material-icons"],["type","email","id","email","name","email","placeholder","Correo electr\xF3nico","required","","email","",1,"form-control","border-start-0",3,"ngModelChange","ngModel"],[4,"ngIf"],["type","password","id","password","name","password","placeholder","Contrase\xF1a","required","","pattern","^(?=.*[A-Z])(?=.*\\d)(?=.*[!@#$%^&*()_+\\[\\]{};':\\\\|,.\\/?]).{8,}$",1,"form-control","border-start-0",3,"ngModelChange","ngModel"],[1,"form-check","form-switch","form-check-reverse",2,"margin","10px"],["type","checkbox","id","flexSwitchCheckReverse","name","isAdmin",1,"form-check-input",3,"ngModelChange","ngModel"],["for","flexSwitchCheckReverse",1,"form-check-label"],["type","submit",1,"btn","btn-primary","w-100","mb-3",2,"border-radius","25px","padding","10px"],["class","text-danger text-center",4,"ngIf"],[1,"text-danger"],[1,"text-danger","text-center"]],template:function(r,o){if(r&1){let a=T();s(0,"div",2)(1,"div",3)(2,"div",4)(3,"h2",5),l(4,"Iniciar Sesi\xF3n"),m(),s(5,"form",6,0),U("ngSubmit",function(){return u(a),f(o.onLogin())}),s(7,"div",7)(8,"span",8),l(9,"account_circle"),m(),s(10,"input",9),M("ngModelChange",function(c){return u(a),b(o.email,c)||(o.email=c),f(c)}),m()(),S(11,me,3,0,"div",10),s(12,"div",7)(13,"span",8),l(14,"lock"),m(),s(15,"input",11,1),M("ngModelChange",function(c){return u(a),b(o.password,c)||(o.password=c),f(c)}),m()(),S(17,ce,3,0,"div",10),s(18,"div",12)(19,"input",13),M("ngModelChange",function(c){return u(a),b(o.isAdmin,c)||(o.isAdmin=c),f(c)}),m(),s(20,"label",14),l(21," Iniciar como administrador "),m()(),s(22,"button",15),l(23," Iniciar Sesi\xF3n "),m(),S(24,le,2,1,"div",16),m()()()(),P(25,"app-footer")}if(r&2){let a=L(6),n=L(16);d(10),x("ngModel",o.email),d(),C("ngIf",(a.controls.email==null?null:a.controls.email.invalid)&&(a.controls.email.dirty||a.controls.email.touched)),d(4),x("ngModel",o.password),d(2),C("ngIf",n.invalid&&(n.dirty||n.touched)),d(2),x("ngModel",o.isAdmin),d(5),C("ngIf",o.errorMessage)}},dependencies:[B,Q,J,H,G,Z,X,$,Y,K,z,ee],styles:[".abs-center[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:97vh}.card[_ngcontent-%COMP%]{min-width:50vw}"]});let t=e;return t})();var de=[{path:"",component:ie}],re=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=y({type:e}),e.\u0275inj=v({imports:[N.forChild(de),N]});let t=e;return t})();var ke=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=y({type:e}),e.\u0275inj=v({providers:[E,j,A],imports:[O,re,te]});let t=e;return t})();export{ke as LoginModule};
