import{a as w}from"./chunk-EUPQWNRB.js";import{a as x}from"./chunk-3MGN2CRD.js";import{a as V,c as R,d as z,h as G}from"./chunk-ZLLD3L34.js";import{D as C,Ea as W,F as m,Ga as q,H as a,Ha as I,I as r,J as S,K as y,L as g,La as A,M as f,Ma as L,N,P as c,Pa as B,S as E,T as F,U as O,da as T,ea as j,f as P,h as M,ia as D,l as _,p as k,q as h,r as b,s as v,x as s,y as u}from"./chunk-ZHU3U647.js";function U(n,e){n&1&&(a(0,"div",14),c(1," La descripci\xF3n es obligatoria. "),r())}function X(n,e){if(n&1){let p=y();a(0,"button",19),g("click",function(){b(p);let t=f().index,o=f();return v(o.quitarOpcion(t))}),c(1," - "),r()}}function Y(n,e){if(n&1){let p=y();a(0,"button",20),g("click",function(){b(p);let t=f(2);return v(t.agregarOpcion())}),c(1," + "),r()}}function Z(n,e){if(n&1){let p=y();a(0,"div",15)(1,"input",16),O("ngModelChange",function(t){let o=b(p).$implicit;return F(o.opcion,t)||(o.opcion=t),v(t)}),r(),C(2,X,2,0,"button",17)(3,Y,2,0,"button",18),r()}if(n&2){let p=e.$implicit,i=e.index,t=f();s(),N("placeholder","Escribe la opci\xF3n ",i+1,""),E("ngModel",p.opcion),s(),m("ngIf",t.opciones.length>2),s(),m("ngIf",i===t.opciones.length-1)}}var J=(()=>{let e=class e{constructor(i,t,o,l){this.router=i,this.preguntasService=t,this.opcionesService=o,this.route=l,this.descripcion="",this.opciones=[{opcion:"",id_pregunta:0,id_opcion:0},{opcion:"",id_pregunta:0,id_opcion:0}]}ngOnInit(){this.route.params.subscribe(i=>{this.id=+i.id,this.id&&this.enviarFormulario()})}agregarOpcion(){this.opciones.push({opcion:"",id_pregunta:0,id_opcion:0})}quitarOpcion(i){this.opciones.length>2&&this.opciones.splice(i,1)}esFormularioValido(){return this.descripcion.trim()!==""&&this.opciones.every(i=>i.opcion.trim()!=="")&&this.opciones.length>=1}enviarFormulario(){return P(this,null,function*(){if(this.esFormularioValido())try{let i={id_pregunta:0,descripcion:this.descripcion,id_asamblea:this.id},t=yield M(this.preguntasService.post(V.crearPregunta,i));if(t&&t.respuesta){let o=t.respuesta;yield Promise.all(this.opciones.map(l=>P(this,null,function*(){let d={opcion:l.opcion,id_pregunta:o,id_asamblea:this.id};try{yield M(this.opcionesService.post(V.createOpcion,d))}catch(Q){console.error("Error al crear la opci\xF3n:",l,Q)}}))),this.router.navigate(["/asambleas/editar-preguntas/",this.id])}else console.error("Error al crear la pregunta:",t)}catch(i){console.error("Error al crear la pregunta o las opciones:",i)}})}volver(){this.router.navigate(["/asambleas/editar-preguntas/",this.id])}};e.\u0275fac=function(t){return new(t||e)(u(q),u(x),u(w),u(W))},e.\u0275cmp=k({type:e,selectors:[["app-creacion-preguntas"]],decls:21,vars:4,consts:[[1,"container","py-3"],[1,"abs-center"],[1,"card","shadow-lg","border-0"],[1,"card-body","row","g-3"],[1,"text-center","fs-2","text-primary","mb-4"],[1,"mb-4"],["for","descripcion",1,"form-label"],["id","descripcion","rows","3","placeholder","Escribe la descripci\xF3n de la pregunta aqu\xED...",1,"form-control",3,"ngModelChange","ngModel"],["class","text-danger mt-1",4,"ngIf"],[1,"mb-3"],["for","opciones",1,"form-label"],["class","input-group mb-2",4,"ngFor","ngForOf"],[1,"btn","btn-success","w-100","mt-3",3,"click","disabled"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"text-danger","mt-1"],[1,"input-group","mb-2"],["type","text",1,"form-control",3,"ngModelChange","ngModel","placeholder"],["class","btn btn-danger","type","button",3,"click",4,"ngIf"],["class","btn btn-primary","type","button",3,"click",4,"ngIf"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(t,o){t&1&&(S(0,"app-nav"),a(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"h2",4),c(6,"Crear Nueva Pregunta"),r(),a(7,"div",5)(8,"label",6),c(9,"Descripci\xF3n"),r(),a(10,"textarea",7),O("ngModelChange",function(d){return F(o.descripcion,d)||(o.descripcion=d),d}),r(),C(11,U,2,0,"div",8),r(),a(12,"div",9)(13,"label",10),c(14,"Opciones"),r(),C(15,Z,4,5,"div",11),r(),a(16,"button",12),g("click",function(){return o.enviarFormulario()}),c(17," Crear Pregunta "),r(),a(18,"button",13),g("click",function(){return o.volver()}),c(19,"Volver"),r()()()()(),S(20,"app-footer")),t&2&&(s(10),E("ngModel",o.descripcion),s(),m("ngIf",o.descripcion.trim()===""&&o.descripcion.length>0),s(4),m("ngForOf",o.opciones),s(),m("disabled",!o.esFormularioValido()))},dependencies:[T,j,A,L,B,R,z],styles:[".container[_ngcontent-%COMP%]{padding:1rem}.abs-center[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:70vh}.card[_ngcontent-%COMP%]{min-width:90vw}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}button[_ngcontent-%COMP%]{margin-left:2px}"]});let n=e;return n})();var $=[{path:"",component:J}],K=(()=>{let e=class e{};e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h({type:e}),e.\u0275inj=_({imports:[I.forChild($),I]});let n=e;return n})();var ye=(()=>{let e=class e{};e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h({type:e}),e.\u0275inj=_({providers:[x,w],imports:[D,K,G]});let n=e;return n})();export{ye as CreacionPreguntasdModule};
