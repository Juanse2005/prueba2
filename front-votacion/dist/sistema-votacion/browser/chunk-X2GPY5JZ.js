import{a as x}from"./chunk-OXAWYZPD.js";import{a as C}from"./chunk-KK3FQ2IU.js";import{a as b,c as L,d as q,e as G,h as J}from"./chunk-ZLLD3L34.js";import{D as U,Ea as B,F as d,Ga as V,H as n,Ha as T,I as o,J as E,K as N,L as g,La as W,M as v,Ma as R,P as s,Pa as D,Q as u,R as k,S as I,T as j,U as w,W as z,bb as H,ca as A,da as F,ea as O,ia as P,l as f,p as M,q as _,r as S,s as y,x as l,y as h}from"./chunk-ZHU3U647.js";var Y=(a,t)=>({"btn-success":a,"btn-danger":t});function Z(a,t){a&1&&(n(0,"span",25),s(1,"check"),o())}function $(a,t){a&1&&(n(0,"span",26),s(1,"close"),o())}function ee(a,t){if(a&1){let c=N();n(0,"tr")(1,"th",18),s(2),o(),n(3,"td"),s(4),o(),n(5,"td"),s(6),o(),n(7,"td"),s(8),o(),n(9,"td"),s(10),o(),n(11,"td"),s(12),o(),n(13,"td",19)(14,"button",20),g("click",function(){let i=S(c).$implicit,r=v();return y(r.editarUsuario(i.id_usuario))}),n(15,"i",21),s(16,"edit"),o()(),n(17,"button",22),g("click",function(){let i=S(c).$implicit,r=v();return y(r.toggleEstado(i))}),U(18,Z,2,0,"span",23)(19,$,2,0,"span",24),o()()()}if(a&2){let c=t.$implicit,e=t.index,i=v();l(2),u((i.page-1)*i.pageSize+(e+1)),l(2),u(c.nombre),l(2),u(c.apartamento),l(2),u(c.email),l(2),u(c.tipo_rol),l(2),u(c.estado),l(2),d("disabled",c.estado==="Inactivo"),l(3),d("ngClass",z(11,Y,c.estado==="Activo",c.estado==="Inactivo"))("disabled",c.estado==="Inactivo"),l(),d("ngIf",c.estado==="Activo"),l(),d("ngIf",c.estado==="Inactivo")}}function te(a,t){a&1&&(n(0,"tr")(1,"td",27),s(2,"No se encontraron Usuarios."),o()())}var Q=(()=>{let t=class t{constructor(e,i,r,m){this.router=e,this.route=i,this.usuarioService=r,this.conjuntoService=m,this.page=1,this.pageSize=6,this.totalUsuarios=0,this.usuarios=[],this.filteredUsuarios=[],this.searchUsuarios="",this.conjuntos={}}ngOnInit(){this.route.params.subscribe(e=>{this.id_conjunto=+e.id,this.id_conjunto&&(this.refreshUsuarios(),this.tituloUsuario())})}tituloUsuario(){this.id_conjunto&&this.conjuntoService.getById(b.getAllConjuntos,this.id_conjunto).subscribe({next:e=>{this.conjuntos=e.respuesta[0].nombre},error:e=>console.error("Error al obtener titulo",e)})}editarUsuario(e){this.router.navigate(["/usuarios/edicion-usuario",this.id_conjunto,e])}refreshUsuarios(){this.id_conjunto&&this.usuarioService.getUsuarioById(b.getAllUsuarios,this.id_conjunto).subscribe(e=>{e&&e.respuesta&&e.respuesta.length>0?(this.usuarios=e.respuesta,this.totalUsuarios=this.usuarios.length,this.filterUsuarios()):console.error("No se encontr\xF3 el administrador o la respuesta est\xE1 vac\xEDa")},e=>{console.error("Error al obtener el administrador:",e)})}filterUsuarios(){let e=this.searchUsuarios.toLowerCase(),i=this.usuarios.filter(m=>m.nombre.toLowerCase().includes(e)||m.email.includes(e));this.totalUsuarios=i.length;let r=(this.page-1)*this.pageSize;this.filteredUsuarios=i.slice(r,r+this.pageSize)}trackById(e,i){return i.id_usuario??e}onSearchTermChange(){this.page=1,this.filterUsuarios()}toggleEstado(e){e.estado=e.estado==="Activo"?"Inactivo":"Activo",this.usuarioService.delete(b.deleteUsuario,e.id_usuario,e).subscribe({next:i=>{console.log("Estado del usuario actualizado exitosamente:")},error:i=>{console.error("Error al actualizar el estado del usuario:",i),i.status===401?console.error("No autorizado, redirigiendo al login"):console.error("Error no manejado:",i)}})}volver(){this.router.navigate(["/conjuntos"])}};t.\u0275fac=function(i){return new(i||t)(h(V),h(B),h(C),h(x))},t.\u0275cmp=M({type:t,selectors:[["app-usuarios"]],decls:40,vars:8,consts:[[1,"container","py-3"],[1,"abs-center"],[1,"card","shadow","border-0"],[1,"card-body"],[1,"text-center","fs-2","text-primary","mb-4"],[1,"d-flex","flex-column","flex-md-row","justify-content-between","align-items-md-center","mb-3"],[1,"input-group","w-auto"],["type","text","placeholder","Buscar usuario...",1,"form-control",3,"ngModelChange","input","ngModel"],["id","basic-addon1",1,"input-group-text"],[1,"material-icons"],[1,"table-responsive"],[1,"table","table-striped","text-center"],["scope","col"],[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[1,"d-flex","align-items-center","justify-content-start","gap-3","p-2"],["type","button",1,"btn","btn-secondary",3,"click"],[2,"height","40px",3,"pageChange","collectionSize","page","pageSize"],["scope","row"],[1,"d-flex","justify-content-center","align-items-center"],["title","Editar",1,"btn","btn-warning",2,"font-size","20px","margin-right","5px",3,"click","disabled"],[1,"material-icons","align-middle",2,"font-size","20px","margin-right","5px"],[1,"btn",3,"click","ngClass","disabled"],["class","material-icons","title","Activo",4,"ngIf"],["class","material-icons","title","Inactivo",4,"ngIf"],["title","Activo",1,"material-icons"],["title","Inactivo",1,"material-icons"],["colspan","10",2,"text-align","center"]],template:function(i,r){i&1&&(E(0,"app-animation")(1,"app-nav"),n(2,"div",0)(3,"div",1)(4,"div",2)(5,"div",3)(6,"h2",4),s(7),o(),n(8,"div",5)(9,"div",6)(10,"input",7),w("ngModelChange",function(p){return j(r.searchUsuarios,p)||(r.searchUsuarios=p),p}),g("input",function(){return r.onSearchTermChange()}),o(),n(11,"span",8)(12,"i",9),s(13,"search"),o()()()(),n(14,"div",10)(15,"table",11)(16,"thead")(17,"tr")(18,"th",12),s(19,"#"),o(),n(20,"th",12),s(21,"Nombre"),o(),n(22,"th",12),s(23,"Apartamento"),o(),n(24,"th",12),s(25,"Correo"),o(),n(26,"th",12),s(27,"Rol"),o(),n(28,"th",12),s(29,"Estado"),o(),n(30,"th",12),s(31,"Acciones"),o()()(),n(32,"tbody"),U(33,ee,20,14,"tr",13)(34,te,3,0,"tr",14),o()()(),n(35,"div",15)(36,"button",16),g("click",function(){return r.volver()}),s(37,"Volver"),o(),n(38,"ngb-pagination",17),w("pageChange",function(p){return j(r.page,p)||(r.page=p),p}),g("pageChange",function(){return r.refreshUsuarios()}),o()()()()()(),E(39,"app-footer")),i&2&&(l(7),k("Residentes del conjunto ",r.conjuntos,""),l(3),I("ngModel",r.searchUsuarios),l(23),d("ngForOf",r.filteredUsuarios)("ngForTrackBy",r.trackById),l(),d("ngIf",r.filteredUsuarios.length===0),l(4),d("collectionSize",r.totalUsuarios),I("page",r.page),d("pageSize",r.pageSize))},dependencies:[A,F,O,W,R,D,L,q,G,H],styles:[".chart-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;width:100%}p-chart[_ngcontent-%COMP%]{width:35rem}.container[_ngcontent-%COMP%]{padding:1rem}.abs-center[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:70vh}.card[_ngcontent-%COMP%]{min-width:90vw}"]});let a=t;return a})();var ie=[{path:"",component:Q}],X=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=_({type:t}),t.\u0275inj=f({imports:[T.forChild(ie),T]});let a=t;return a})();var Ue=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=_({type:t}),t.\u0275inj=f({providers:[C,x],imports:[P,X,J]});let a=t;return a})();export{Ue as UsuarioModule};
